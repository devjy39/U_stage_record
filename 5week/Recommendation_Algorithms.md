## 군집 탐색 Community Detection
- 배치 모형(Configuration Model)
<img src=image/Configuration.png width=600 height = 200> 
1. 연결성을 보존한 상태에서
2. 간선들을 무작위로 재배치하여 얻은 그래프

###  군집성(Modularity)
<img src=image/modul.PNG>
 
- 그래프에서 군집 내부 간선의 수가 월등이 많을 수록 성공한 군집 탐색이다.
- 무작위로 연결된 배치 모형과의 비교를 통해 통계적 유의성을 판단.
- 항상 -1~+1 사이 값이고, 보통 0.3 ~ 0.7 일 때 유의미한 군집 탐색이다.

## 군집 탐색 알고리즘

### Girvan-Newman
- 하향식(Top-Down) 군집 탐색 알고리즘
<img src=image/girvan.png  width=500 height = 500> 
1) 전체 그래프에서 시작합니다
2) `매개 중심성`이 높은 순서로 간선을 제거하면서, 군집성을 변화를 기록합니다- `매개중심성`: 간선이 정점 간 최단 경로에 놓이는 횟수
3) 군집성이 가장 커지는 상황을 복원합니다
4) 이 때, 서로 연결된 정점들, 즉 연결 요소를 하나의 군집으로 간주합니다
- 즉, 전체 그래프에서 시작해서 점점 작은 단위를 검색하는 하향식(Top-Down) 방법입니다

<img src=image/newman.PNG> 
- 군집성이 최대가 되는 지점까지 간선을 제거한다.

###  Louvain
- 상향식(Bottom-Up) 군집 탐색 알고리즘
- 개별 정점에서 시작하여 점점 큰 군집으로 합침
1. 개별 정점부터 시작.
2. 군집성이 최대화 되도록 군집 결정
3. 더 이상 군집성이 증가하지 않을 때까지 반복
4. 한 개의 정점이 남을 때까지 반복

#### 위의 알고리즘들은 중첩 군집을 가정하지 않음.

## 중첩 군집 구조
- 중첩 군집 모형이 주어지면, 주어진 그래프의 확률을 계산할 수 있다.

그래프의 확률은 다음 확률들의 곱입니다
1) 그래프의 각 간선의 두 정점이 (모형에 의해) 직접 연결될 확률
2) 그래프에서 직접 연결되지 않은 각 정점 쌍이 (모형에 의해) 직접 연결되지 않을 확률
<img src=image/nesting.PNG>
`최우도 추정치(Maximum Likelihood Estimate)` 라고도 함

- 완화된 중첩 군집 모형에서는 각 정점이 각 군집에 속해 있는 정도를 실숫값으로 표현함.
<img src=image/ease.PNG>
 
- 최적화 관점에서는, 모형의 매개변수들이 실수 값을 가지기 때문에
- 익숙한 최적화 도구 (`경사하강법` 등)을 사용하여 모형을 탐색할 수 있음

### 중첩 군집 탐색
- 주어진 그래프의 확률을 최대화하는 중첩 군집 모형을 찾는 과정

## 추천 시스템

## 내용 기반 추천
1. 선호했던 상품 프로필 수집
- 해당 상품의 특성을 나열한 벡터 - 웟핫 인코딩
2. 사용자 프로필 구성
- 1번을 사용하여 가중 평균 계산 - 벡터
3. 사용자 프로필과 상품 프로필을 매칭 - 코사인 유사도를 이용함
<img src=image/cos.PNG>
 
- 두 벡터의 각도가 좁으면 코사인 유사도는 높아진다.
5. 유사도가 높은 상품들을 추천

### 장점
1. 다른 사용자의 구매 기록이 필요하지 않습니다
2. 독특한 취향의 사용자에게도 추천이 가능합니다
3. 새 상품에 대해서도 추천이 가능합니다
4. 추천의 이유를 제공할 수 있습니다
- 예시: 당신은 로맨스 영화를 선호했기 때문에, 새로운 로맨스 영화를 추천합니다

### 단점
1. 상품에 대한 부가 정보가 없는 경우에는 사용할 수 없습니다
2. 구매 기록이 없는 사용자에게는 사용할 수 없습니다
3. 과적합(Overfitting)으로 지나치게 협소한 추천을 할 위험이 있습니다

## 협업 필터링 추천
- 대표적으로 사용자-사용자 협업 필터링
- 유사한 취향의 사용자들이 선호한 상품을 찾아냄

### 상관 계수(Correlation Coefficient)
<img src=image/correlation.PNG>
 
- 취향의 유사성 -> 상관 계수 -> 일치가 많을 수록 + 값 불일치는 - 값을 갖게됨.
- 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 통해 평점을 추정
- 앞서 설명한 상관 계수를 이용하여 상품 𝑠를 구매한 사용자 중에
- 𝑥와 취향이 가장 유사한 𝑘명의 사용자 𝑁(𝑥; 𝑠)를 뽑고 수식을 이용해 추정.
<img src=image/sin.PNG>
 
- 취향의 유사도를 가중치로 사용한 평점의 `가중 평균`을 계산
- 최종적으로 추정한 평점이 가장 높은 상품을 추천

### 장점
- (+) 상품에 대한 부가 정보가 없는 경우에도 사용할 수 있습니다

### 단점
- (−) 충분한 수의 평점 데이터가 누적되어야 효과적입니다
- (−) 새 상품, 새로운 사용자에 대한 추천이 불가능합니다
- (−) 독특한 취향의 사용자에게 추천이 어렵습니다

## 추천 시스템의 평가
1. 데이터 분리
  - 데이터를 훈련(Training) 데이터와 평가(Test) 데이터로 분리
  - 평가 데이터는 주어지지 않았다고 가정하고,
  - 훈련 데이터를 이용해서 가리워진 평가 데이터의 평점을 추정 후 비교하여 오차를 측정.
  - 오차를 측정하는 지표로는 `평균 제곱 오차(Mean Squared Error, MSE)`가 많이 사용된다.
  - 평균 제곱근 오차(Root Mean Squared Error, RMSE)도 많이 사용됨.
<img src=image/rmse.PNG>

2. 평가 지표 - 다양한 방법들 존재
- 추정한 평점으로 순위를 매긴 후, 실제 평점으로 매긴 순위와의 상관 계수를 계산하기도 합니다
- 추천한 상품 중 실제 구매로 이루어진 것의 비율을 측정하기도 합니다
- 추천의 순서 혹은 다양성까지 고려하는 지표들도 사용됩니다



